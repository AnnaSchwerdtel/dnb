#+TITLE:
#+AUTHOR: 
#+EMAIL: 
#+KEYWORDS:
#+DESCRIPTION:
#+TAGS:
#+LANGUAGE: en
#+OPTIONS: toc:nil ':t H:5
#+STARTUP: hidestars overview
#+LaTeX_CLASS: scrartcl
#+LaTeX_CLASS_OPTIONS: [a4paper,11pt]
#+PANDOC_OPTIONS:

* merging DNB and Wikidata

* convert RDF to JSON
#+BEGIN_SRC sh
  rdf2json.py DNBTitel.rdf.gz | gzip -c > DNBTitel.json.gz
#+END_SRC

* cleaning the DNB data

** pages
Let's have a look at the distribution of entries in the "pages"
field. First, we dump the data:
#+BEGIN_SRC sh
  ./json2json.py -p pages DNBTitel.json.gz > pages.tsv
#+END_SRC

Now we can normalise the pages and extract those with meaningful
information:
#+BEGIN_SRC sh :results silent
  ./json2json.py --normalise --print "pages_norm" DNBTitel.json.gz \
      | grep "^[0-9][0-9]*$" | sort -S1G | uniq -c \
      | awk '{print $2"\t"$1}' | sort -n > pages_freq.tsv
#+END_SRC

Let us plot the distribution:
#+BEGIN_SRC gnuplot :results silent
set term svg enhanced size 800,600
set out 'pages.svg'
set grid
set xrange [0:4000]
set logscale y
set format y "10^%T"

set xlabel 'number of pages'
set ylabel 'frequency'

plot 'pages_freq.tsv' using 1:2 with lines title ''

set term png enhanced size 800,600
set out 'pages.png'
replot
#+END_SRC

[[pages.png]]

** issued
Extract and normalise the patterns for the "issued" field:
#+BEGIN_SRC sh :results silent
  ./json2json.py --norm --print "type,issued" DNBTitel.json.gz | sed "s/[0-9]/0/g" > issued.tsv
#+END_SRC

Let's have a look at the most frequent patterns:
#+BEGIN_SRC sh
  echo "type\tissued pattern\tfrequency"
  sort -S1G issued.tsv | uniq -c | sort -nr | head
  echo "*distinct pairs\t\t*" $(sort -S1G -u issued.tsv| wc -l)
#+END_SRC

| type             | issued pattern | frequency |
|------------------+----------------+-----------|
| Document         |              0 |  10559276 |
| Issue            |              0 |   1470687 |
| Article          |              0 |    981040 |
| Collection       |                |    381824 |
| Periodical       |      0000-0000 |    304933 |
| Periodical       |          0000- |    155810 |
| Series           |          0000- |     62002 |
| Series           |              0 |     42707 |
| Document         |                |     41579 |
| Periodical       |              0 |     25939 |
|------------------+----------------+-----------|
| *distinct pairs* |                |       105 |

